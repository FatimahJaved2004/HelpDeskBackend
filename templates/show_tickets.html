{% extends 'base_dashboard.html' %}

{% block title %}Your Tickets{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Your Tickets</h2>
    <a href="{{ url_for('submit_ticket') }}" class="btn btn-success">Submit New Ticket</a>
  </div>

  {% if tickets %}
    <div class="table-responsive">
  <table class="table table-hover">
  <thead>
    <tr>
      <th>Title</th>
      <th>Description</th>
      <th>Status</th>
      <th>Posted</th>
    </tr>
  </thead>
  <tbody>
    {% for ticket in tickets %}
      <tr class="clickable-row" data-href="{{ url_for('view_ticket', ticket_id=ticket['id']) }}">
        <td>{{ ticket['title'] }}</td>
        <td>{{ ticket['description'][:50] }}{% if ticket['description']|length > 50 %}...{% endif %}</td>
        <td>{{ ticket['status'] }}</td>
        <td>{{ ticket['created_at'] }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const rows = document.querySelectorAll('.clickable-row');
    rows.forEach(row => {
      row.addEventListener('click', () => {
        window.location = row.getAttribute('data-href');
      });
    });
  });
</script>


    </div>
  {% else %}
    <div class="alert alert-info">No tickets found.</div>
  {% endif %}
{% endblock %}
